{% extends 'base.html' %}
{% load static %}

{% block title %}Nouvel Enseignant - eSchool{% endblock %}

{% block content %}
{% csrf_token %}
<div class="max-w-6xl mx-auto py-8 px-4 sm:px-6 lg:px-8">
  <!-- En-t√™te de page -->
  <div class="mb-10">
    <div class="bg-gradient-to-r from-indigo-600 to-purple-700 rounded-xl p-6 shadow-lg">
      <div class="sm:flex sm:items-center">
        <div class="sm:flex-auto">
          <div class="flex items-center space-x-4">
            <div class="bg-white/20 rounded-full p-3">
              <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
              </svg>
            </div>
            <div>
              <h1 class="text-3xl font-bold text-white">üë®‚Äçüè´ Nouvel Enseignant</h1>
              <p class="mt-2 text-indigo-100">Ajouter un nouvel enseignant au syst√®me</p>
            </div>
          </div>
        </div>
        <div class="mt-6 sm:mt-0 sm:ml-16 sm:flex-none">
          <a href="{% url 'accounts:teacher_list' %}" 
             class="inline-flex items-center justify-center rounded-lg border-2 border-white bg-white/10 backdrop-blur-sm px-6 py-3 text-sm font-medium text-white shadow-lg hover:bg-white/20 transition-all duration-200">
            <svg class="-ml-1 mr-2 h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
            </svg>
            Retour √† la liste
          </a>
        </div>
      </div>
    </div>
  </div>

  <!-- Formulaire de cr√©ation -->
  <div class="bg-white shadow-2xl rounded-2xl overflow-hidden border border-gray-100">
    <form method="post" class="divide-y divide-gray-100">
      {% csrf_token %}
      
      <!-- Informations personnelles -->
      <div class="px-8 py-8">
        <div class="flex items-center mb-6">
          <div class="bg-blue-100 rounded-lg p-3 mr-4">
            <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
            </svg>
          </div>
          <div>
            <h3 class="text-xl font-semibold text-gray-900">Informations personnelles</h3>
            <p class="text-sm text-gray-500">Informations de base du nouvel enseignant</p>
          </div>
        </div>
        
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
          <!-- Pr√©nom -->
          <div class="space-y-2">
            <label for="first_name" class="block text-sm font-semibold text-gray-700">Pr√©nom *</label>
            <input type="text" 
                   id="first_name" 
                   name="first_name" 
                   required
                   class="block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all duration-200 hover:border-gray-400">
          </div>
          
          <!-- Nom -->
          <div class="space-y-2">
            <label for="last_name" class="block text-sm font-semibold text-gray-700">Nom *</label>
            <input type="text" 
                   id="last_name" 
                   name="last_name" 
                   required
                   class="block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all duration-200 hover:border-gray-400">
          </div>
          
          <!-- Email -->
          <div class="space-y-2">
            <label for="email" class="block text-sm font-semibold text-gray-700">Adresse e-mail *</label>
            <input type="email" 
                   id="email" 
                   name="email" 
                   required
                   class="block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all duration-200 hover:border-gray-400">
          </div>
          
          <!-- T√©l√©phone -->
          <div class="space-y-2">
            <label for="phone" class="block text-sm font-semibold text-gray-700">T√©l√©phone</label>
            <input type="tel" 
                   id="phone" 
                   name="phone" 
                   class="block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all duration-200 hover:border-gray-400">
          </div>
          
          <!-- Date de naissance -->
          <div class="space-y-2">
            <label for="date_of_birth" class="block text-sm font-semibold text-gray-700">Date de naissance</label>
            <input type="date" 
                   id="date_of_birth" 
                   name="date_of_birth" 
                   class="block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all duration-200 hover:border-gray-400">
          </div>
          
          <!-- Genre -->
          <div class="space-y-2">
            <label for="gender" class="block text-sm font-semibold text-gray-700">Genre</label>
            <select id="gender" 
                    name="gender"
                    class="block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all duration-200 hover:border-gray-400">
              <option value="">-- S√©lectionner --</option>
              <option value="M">Masculin</option>
              <option value="F">F√©minin</option>
            </select>
          </div>
        </div>
        
        <!-- Adresse -->
        <div class="mt-8 space-y-2">
          <label for="address" class="block text-sm font-semibold text-gray-700">Adresse compl√®te</label>
          <textarea id="address" 
                    name="address" 
                    rows="3"
                    placeholder="Entrez l'adresse compl√®te de l'enseignant..."
                    class="block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all duration-200 hover:border-gray-400 resize-none"></textarea>
        </div>
      </div>
      
      <!-- Informations professionnelles -->
      <div class="px-8 py-8 bg-gray-50">
        <div class="flex items-center mb-6">
          <div class="bg-purple-100 rounded-lg p-3 mr-4">
            <svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2-2v2m8 0V6a2 2 0 00-2 2H6a2 2 0 00-2-2V4m8 0H8m0 0v2H6m2-2V2m8 4v10.938"></path>
            </svg>
          </div>
          <div>
            <h3 class="text-xl font-semibold text-gray-900">Informations professionnelles</h3>
            <p class="text-sm text-gray-500">D√©tails de l'emploi et des qualifications</p>
          </div>
        </div>
        
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
          <!-- ID Employ√© -->
          <div class="space-y-2">
            <label for="employee_id" class="block text-sm font-semibold text-gray-700">ID Employ√© *</label>
            <input type="text" 
                   id="employee_id" 
                   name="employee_id" 
                   value="{{ suggested_employee_id }}"
                   required
                   class="block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-all duration-200 hover:border-gray-400">
            <p class="text-xs text-gray-500">Identifiant unique de l'employ√©</p>
          </div>
          
          <!-- Date d'embauche -->
          <div class="space-y-2">
            <label for="hire_date" class="block text-sm font-semibold text-gray-700">Date d'embauche</label>
            <input type="date" 
                   id="hire_date" 
                   name="hire_date" 
                   value="{{ today|date:'Y-m-d' }}"
                   class="block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-all duration-200 hover:border-gray-400">
          </div>
          
          <!-- Niveau d'√©ducation -->
          <div class="space-y-2">
            <label for="education_level" class="block text-sm font-semibold text-gray-700">Niveau d'√©ducation</label>
            <input type="text" 
                   id="education_level" 
                   name="education_level" 
                   placeholder="Ex: Master en Math√©matiques, Licence en Histoire..."
                   class="block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-all duration-200 hover:border-gray-400">
          </div>
          
          <!-- Professeur principal -->
          <div class="space-y-2">
            <label class="block text-sm font-semibold text-gray-700">Statut sp√©cial</label>
            <div class="flex items-center p-4 border-2 border-dashed border-purple-300 rounded-lg bg-purple-50">
              <input type="checkbox" 
                     id="is_head_teacher" 
                     name="is_head_teacher"
                     class="h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded">
              <label for="is_head_teacher" class="ml-3 text-sm font-medium text-purple-800">
                üëë Professeur principal
              </label>
            </div>
          </div>
        </div>
        
        <!-- Mati√®res enseign√©es -->
        <div class="mt-8 space-y-2">
          <label class="block text-sm font-semibold text-gray-700">Mati√®res enseign√©es</label>
          <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3 p-4 border border-gray-300 rounded-lg bg-white">
            {% for subject in subjects %}
              <div class="flex items-center">
                <input type="checkbox" 
                       id="subject_{{ subject.id }}" 
                       name="subjects" 
                       value="{{ subject.id }}"
                       class="h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded">
                <label for="subject_{{ subject.id }}" class="ml-2 text-sm text-gray-700">
                  {{ subject.name }}
                </label>
              </div>
            {% empty %}
              <p class="text-sm text-gray-500 col-span-full">Aucune mati√®re disponible</p>
            {% endfor %}
          </div>
        </div>
        
        <!-- Certifications -->
        <div class="mt-8 space-y-2">
          <label for="certifications" class="block text-sm font-semibold text-gray-700">Certifications et qualifications</label>
          <textarea id="certifications" 
                    name="certifications" 
                    rows="4"
                    placeholder="Listez les certifications, dipl√¥mes et qualifications sp√©ciales..."
                    class="block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-all duration-200 hover:border-gray-400 resize-none"></textarea>
        </div>
      </div>
      
      <!-- Informations importantes -->
      <div class="px-8 py-6 bg-yellow-50 border-l-4 border-yellow-400">
        <div class="flex items-start">
          <div class="flex-shrink-0">
            <svg class="h-5 w-5 text-yellow-400" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path>
            </svg>
          </div>
          <div class="ml-3">
            <h3 class="text-sm font-medium text-yellow-800">Informations importantes</h3>
            <div class="mt-2 text-sm text-yellow-700">
              <ul class="list-disc list-inside space-y-1">
                <li>Un mot de passe temporaire <strong>"temp123456"</strong> sera g√©n√©r√©</li>
                <li>L'enseignant devra changer son mot de passe lors de sa premi√®re connexion</li>
                <li>Un email de bienvenue avec les instructions sera envoy√© √† l'adresse fournie</li>
                <li>Le compte sera automatiquement activ√©</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Actions -->
      <div class="px-8 py-6 bg-gradient-to-r from-gray-50 to-gray-100 flex flex-col sm:flex-row justify-between items-center space-y-4 sm:space-y-0 sm:space-x-4">
        <div class="flex items-center space-x-2 text-sm text-gray-600">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
          </svg>
          <span>Les champs marqu√©s d'un * sont obligatoires</span>
        </div>
        
        <div class="flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-3 w-full sm:w-auto">
          <a href="{% url 'accounts:teacher_list' %}" 
             class="inline-flex items-center justify-center px-6 py-3 border-2 border-gray-300 rounded-xl shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 hover:border-gray-400 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-all duration-200 w-full sm:w-auto">
            <svg class="-ml-1 mr-2 h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
            Annuler
          </a>
          <button type="submit" 
                  class="inline-flex items-center justify-center px-8 py-3 border border-transparent rounded-xl shadow-lg text-sm font-semibold text-white bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transform hover:scale-105 transition-all duration-200 w-full sm:w-auto">
            <svg class="-ml-1 mr-2 h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
            </svg>
            Cr√©er l'enseignant
          </button>
        </div>
      </div>
    </form>
  </div>
</div>

<script>
// Animation au chargement
document.addEventListener('DOMContentLoaded', function() {
  const form = document.querySelector('form');
  form.classList.add('opacity-0');
  
  setTimeout(() => {
    form.classList.remove('opacity-0');
    form.classList.add('animate-fadeInUp');
  }, 100);
  
  // Animation sur les champs
  const inputs = document.querySelectorAll('input, select, textarea');
  inputs.forEach(input => {
    input.addEventListener('focus', function() {
      this.parentElement.classList.add('transform', 'scale-105');
    });
    
    input.addEventListener('blur', function() {
      this.parentElement.classList.remove('transform', 'scale-105');
    });
  });
});

// Validation c√¥t√© client
document.querySelector('form').addEventListener('submit', function(e) {
  const firstName = document.getElementById('first_name').value.trim();
  const lastName = document.getElementById('last_name').value.trim();
  const email = document.getElementById('email').value.trim();
  const employeeId = document.getElementById('employee_id').value.trim();
  
  // Validation des champs obligatoires
  if (!firstName || !lastName || !email || !employeeId) {
    e.preventDefault();
    showNotification('Veuillez remplir tous les champs obligatoires.', 'error');
    return false;
  }
  
  // Validation email
  const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
  if (!emailRegex.test(email)) {
    e.preventDefault();
    showNotification('Veuillez entrer une adresse e-mail valide.', 'error');
    return false;
  }
  
  // Animation de soumission
  const submitBtn = document.querySelector('button[type="submit"]');
  const originalText = submitBtn.innerHTML;
  submitBtn.innerHTML = '<svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="m4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>Cr√©ation en cours...';
  submitBtn.disabled = true;
  
  showNotification('Cr√©ation de l\'enseignant...', 'info');
});

// Fonction pour afficher les notifications
function showNotification(message, type = 'info') {
  const notification = document.createElement('div');
  notification.className = `fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg transform transition-all duration-300 translate-x-full ${
    type === 'error' ? 'bg-red-500 text-white' : 
    type === 'success' ? 'bg-green-500 text-white' : 
    'bg-blue-500 text-white'
  }`;
  
  notification.innerHTML = `
    <div class="flex items-center">
      <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
        ${type === 'error' ? 
          '<path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"/>' :
          '<path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"/>'
        }
      </svg>
      <span>${message}</span>
    </div>
  `;
  
  document.body.appendChild(notification);
  
  setTimeout(() => {
    notification.classList.remove('translate-x-full');
  }, 100);
  
  setTimeout(() => {
    notification.classList.add('translate-x-full');
    setTimeout(() => {
      if (notification.parentNode) {
        notification.parentNode.removeChild(notification);
      }
    }, 300);
  }, 3000);
}

// G√©n√©rer un nouvel ID employ√©
function generateEmployeeId() {
  const randomNum = Math.floor(Math.random() * 9000) + 1000;
  document.getElementById('employee_id').value = 'EMP' + randomNum;
}
</script>

<style>
@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.animate-fadeInUp {
  animation: fadeInUp 0.6s ease-out forwards;
}

.transition-all {
  transition: all 0.2s ease-in-out;
}

input:focus, select:focus, textarea:focus {
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(79, 70, 229, 0.15);
}

button:hover, a:hover {
  transform: translateY(-1px);
}

button:active, a:active {
  transform: translateY(0);
}
</style>
{% endblock %}
